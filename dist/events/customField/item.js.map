{"version":3,"file":"item.js","sourceRoot":"/","sources":["events/customField/item.ts"],"names":[],"mappings":"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","sourcesContent":["import { cutoffText, formatTime } from '../../util';\nimport { EventFunction } from '../../util/events';\n\nexport const event: EventFunction = {\n  name: 'UPDATE_CUSTOM_FIELD_ITEM',\n  async onEvent(data) {\n    const _ = data.locale;\n    const resultData: any = {\n      default: {\n        description: data.embedDescription(['card', 'customField']),\n        fields: []\n      },\n      small: {}\n    };\n    const added = data.oldData.value === null;\n    const removed = data.customFieldItem.value === null;\n    switch (data.customField.type) {\n      case 'checkbox':\n        resultData.default.title = _(`webhooks.customfielditem_checkbox_${added}`, {\n          member: data.invoker.webhookSafeName,\n          card: cutoffText(data.card.name, 50),\n          customField: cutoffText(data.customField.name, 50)\n        });\n        resultData.small.description = _(`webhooks.customfielditem_checkbox_${added}`, {\n          member: `[${data.invoker.webhookSafeName}](https://trello.com/${data.invoker.username}?utm_source=tacobot.app)`,\n          card: `[${cutoffText(data.card.name, 25)}](https://trello.com/c/${data.card.shortLink}?utm_source=tacobot.app)`,\n          customField: cutoffText(data.customField.name, 25)\n        });\n        break;\n      case 'text':\n        resultData.default.title = _(`webhooks.customfielditem_${!removed ? 'update' : 'remove'}`, {\n          member: data.invoker.webhookSafeName,\n          card: cutoffText(data.card.name, 50),\n          customField: cutoffText(data.customField.name, 50)\n        });\n        resultData.small.description = _(`webhooks.customfielditem_${!removed ? 'update' : 'remove'}`, {\n          member: `[${data.invoker.webhookSafeName}](https://trello.com/${data.invoker.username}?utm_source=tacobot.app)`,\n          card: `[${cutoffText(data.card.name, 25)}](https://trello.com/c/${data.card.shortLink}?utm_source=tacobot.app)`,\n          customField: cutoffText(data.customField.name, 25)\n        });\n        if (!added)\n          resultData.default.fields.push({\n            name: '*' + _('trello.old_v') + '*',\n            value: data.oldData.value.text,\n            inline: true\n          });\n        if (!removed)\n          resultData.default.fields.push({\n            name: '*' + _('trello.new_v') + '*',\n            value: data.customFieldItem.value.text,\n            inline: true\n          });\n        break;\n      case 'number':\n        resultData.default.title = _(`webhooks.customfielditem_${!removed ? 'update' : 'remove'}`, {\n          member: data.invoker.webhookSafeName,\n          card: cutoffText(data.card.name, 50),\n          customField: cutoffText(data.customField.name, 50)\n        });\n        resultData.small.description = _(`webhooks.customfielditem_${!removed ? 'update' : 'remove'}`, {\n          member: `[${data.invoker.webhookSafeName}](https://trello.com/${data.invoker.username})`,\n          card: `[${cutoffText(data.card.name, 25)}](https://trello.com/c/${data.card.shortLink})`,\n          customField: cutoffText(data.customField.name, 25)\n        });\n        if (!added)\n          resultData.default.fields.push({\n            name: '*' + _('trello.old_v') + '*',\n            value: _.toLocaleString(parseFloat(data.oldData.value.number)),\n            inline: true\n          });\n        if (!removed)\n          resultData.default.fields.push({\n            name: '*' + _('trello.new_v') + '*',\n            value: _.toLocaleString(parseFloat(data.customFieldItem.value.number)),\n            inline: true\n          });\n        break;\n      case 'date':\n        resultData.default.title = _(`webhooks.customfielditem_${!removed ? 'update' : 'remove'}`, {\n          member: data.invoker.webhookSafeName,\n          card: cutoffText(data.card.name, 50),\n          customField: cutoffText(data.customField.name, 50)\n        });\n        resultData.small.description = _(`webhooks.customfielditem_${!removed ? 'update' : 'remove'}`, {\n          member: `[${data.invoker.webhookSafeName}](https://trello.com/${data.invoker.username})`,\n          card: `[${cutoffText(data.card.name, 25)}](https://trello.com/c/${data.card.shortLink})`,\n          customField: cutoffText(data.customField.name, 25)\n        });\n        if (!added)\n          resultData.default.fields.push({\n            name: '*' + _('trello.old_v') + '*',\n            value: formatTime(data.oldData.value.date),\n            inline: true\n          });\n        if (!removed)\n          resultData.default.fields.push({\n            name: '*' + _('trello.new_v') + '*',\n            value: formatTime(data.customFieldItem.value.date),\n            inline: true\n          });\n        break;\n      case 'list':\n        resultData.default.title = _(`webhooks.customfielditem_${data.customFieldItem.idValue ? 'update' : 'remove'}`, {\n          member: data.invoker.webhookSafeName,\n          card: cutoffText(data.card.name, 50),\n          customField: cutoffText(data.customField.name, 50)\n        });\n        resultData.small.description = _(`webhooks.customfielditem_${data.customFieldItem.idValue ? 'update' : 'remove'}`, {\n          member: `[${data.invoker.webhookSafeName}](https://trello.com/${data.invoker.username})`,\n          card: `[${cutoffText(data.card.name, 25)}](https://trello.com/c/${data.card.shortLink})`,\n          customField: cutoffText(data.customField.name, 25)\n        });\n        break;\n    }\n    resultData.small.fields = resultData.default.fields;\n    if (resultData.default.title) return data.send(resultData);\n  }\n};\n"]}