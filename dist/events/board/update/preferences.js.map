{"version":3,"file":"preferences.js","sourceRoot":"/","sources":["events/board/update/preferences.ts"],"names":[],"mappings":";;;AAAA,wCAA2C;AAG9B,QAAA,KAAK,GAAkB;IAClC,IAAI,EAAE,oBAAoB;IAC1B,KAAK,CAAC,OAAO,CAAC,IAAI;QAChB,MAAM,OAAO,GAAG;YACd,WAAW,EAAE,cAAc;YAC3B,QAAQ,EAAE,eAAe;YACzB,MAAM,EAAE,YAAY;YACpB,eAAe,EAAE,aAAa;SAC/B,CAAC;QACF,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QAE9C,IAAI,OAAO,CAAC,IAAI,CAAC,EAAE;YACjB,MAAM,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC;YACtB,OAAO,IAAI,CAAC,IAAI,CAAC;gBACf,OAAO,EAAE;oBACP,KAAK,EAAE,CAAC,CAAC,sBAAsB,OAAO,CAAC,IAAI,CAAC,EAAE,EAAE;wBAC9C,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,eAAe;wBACpC,KAAK,EAAE,IAAA,iBAAU,EAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC;wBACtC,OAAO,EAAE,CAAC,CAAC,UAAU,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC;wBACjE,IAAI,EAAE,CAAC,CAAC,UAAU,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC;qBAC7D,CAAC;oBACF,WAAW,EAAE,EAAE;iBAChB;gBACD,KAAK,EAAE;oBACL,WAAW,EAAE,CAAC,CAAC,sBAAsB,OAAO,CAAC,IAAI,CAAC,EAAE,EAAE;wBACpD,MAAM,EAAE,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,wBAAwB,IAAI,CAAC,OAAO,CAAC,QAAQ,0BAA0B;wBAC/G,KAAK,EAAE,IAAA,iBAAU,EAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC;wBACtC,OAAO,EAAE,CAAC,CAAC,UAAU,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC;wBACjE,IAAI,EAAE,CAAC,CAAC,UAAU,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC;qBAC7D,CAAC;iBACH;aACF,CAAC,CAAC;SACJ;IACH,CAAC;CACF,CAAC","sourcesContent":["import { cutoffText } from '../../../util';\nimport { EventFunction } from '../../../util/events';\n\nexport const event: EventFunction = {\n  name: 'UPDATE_BOARD_PREFS',\n  async onEvent(data) {\n    const prefMap = {\n      invitations: 'invite_perms',\n      comments: 'comment_perms',\n      voting: 'vote_perms',\n      permissionLevel: 'perm_levels'\n    };\n    const pref = Object.keys(data.board.prefs)[0];\n\n    if (prefMap[pref]) {\n      const _ = data.locale;\n      return data.send({\n        default: {\n          title: _(`webhooks.board_set_${prefMap[pref]}`, {\n            member: data.invoker.webhookSafeName,\n            board: cutoffText(data.board.name, 50),\n            oldPerm: _(`trello.${prefMap[pref]}.${data.oldData.prefs[pref]}`),\n            perm: _(`trello.${prefMap[pref]}.${data.board.prefs[pref]}`)\n          }),\n          description: ''\n        },\n        small: {\n          description: _(`webhooks.board_set_${prefMap[pref]}`, {\n            member: `[${data.invoker.webhookSafeName}](https://trello.com/${data.invoker.username}?utm_source=tacobot.app)`,\n            board: cutoffText(data.board.name, 50),\n            oldPerm: _(`trello.${prefMap[pref]}.${data.oldData.prefs[pref]}`),\n            perm: _(`trello.${prefMap[pref]}.${data.board.prefs[pref]}`)\n          })\n        }\n      });\n    }\n  }\n};\n"]}